{% extends 'base.html' %}
{% load static %}

{% block title %}Editar Producto - Marketplace Artesanal{% endblock %}

{% block content %}
<div class="container mt-5 mb-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
                <div class="card-header bg-warning-gradient text-white p-4 text-center border-0"
                    style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h2 class="font-heading mb-0"><i class="bi bi-pencil-square me-2"></i>Editar Producto</h2>
                    <p class="mb-0 opacity-75">Modifica los detalles de tu creación</p>
                </div>
                <div class="card-body p-4 p-md-5">
                    <form method="POST" enctype="multipart/form-data" id="productoForm">
                        {% csrf_token %}

                        {% if form.non_field_errors %}
                        <div class="alert alert-danger">
                            {{ form.non_field_errors }}
                        </div>
                        {% endif %}

                        <div class="mb-4">
                            <label for="{{ form.nombre.id_for_label }}" class="form-label fw-bold text-secondary">Nombre
                                del Producto</label>
                            {{ form.nombre }}
                            {% if form.nombre.errors %}
                            <div class="text-danger small mt-1">{{ form.nombre.errors }}</div>
                            {% endif %}
                        </div>

                        <div class="mb-4">
                            <label for="{{ form.descripcion.id_for_label }}"
                                class="form-label fw-bold text-secondary">Descripción</label>
                            {{ form.descripcion }}
                            {% if form.descripcion.errors %}
                            <div class="text-danger small mt-1">{{ form.descripcion.errors }}</div>
                            {% endif %}
                        </div>

                        <div class="mb-4">
                            <label for="{{ form.precio.id_for_label }}"
                                class="form-label fw-bold text-secondary">Precio</label>
                            {{ form.precio }}
                            <div class="form-text">Precio en CLP.</div>
                            {% if form.precio.errors %}
                            <div class="text-danger small mt-1">{{ form.precio.errors }}</div>
                            {% endif %}
                        </div>

                        <div class="mb-4">
                            <label for="{{ form.stock.id_for_label }}"
                                class="form-label fw-bold text-secondary">Stock</label>
                            {{ form.stock }}
                            {% if form.stock.errors %}
                            <div class="text-danger small mt-1">{{ form.stock.errors }}</div>
                            {% endif %}
                        </div>

                        <div class="mb-4">
                            <label for="{{ form.imagen.id_for_label }}"
                                class="form-label fw-bold text-secondary">Imagen</label>
                            {{ form.imagen }}
                            <div class="form-text">Sube una imagen representativa de tu producto.</div>
                            {% if form.imagen.errors %}
                            <div class="text-danger small mt-1">{{ form.imagen.errors }}</div>
                            {% endif %}
                        </div>

                        <div class="mb-4">
                            <label for="{{ form.categoria.id_for_label }}"
                                class="form-label fw-bold text-secondary">Categoría existente</label>
                            {{ form.categoria }}
                            {% if form.categoria.errors %}
                            <div class="text-danger small mt-1">{{ form.categoria.errors }}</div>
                            {% endif %}
                        </div>

                        <div class="mb-4">
                            <label for="{{ form.nueva_categoria.id_for_label }}"
                                class="form-label fw-bold text-secondary">O crea una nueva categoría</label>
                            {{ form.nueva_categoria }}
                            {% if form.nueva_categoria.errors %}
                            <div class="text-danger small mt-1">{{ form.nueva_categoria.errors }}</div>
                            {% endif %}
                        </div>

                        <div class="d-grid gap-2 mt-5">
                            <button type="submit" class="btn btn-primary btn-lg shadow-sm"
                                style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border:none;">
                                <i class="bi bi-check-circle me-2"></i>Guardar Cambios
                            </button>
                            <a href="{% url 'mi_tienda' %}" class="btn btn-outline-secondary">Cancelar</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const inputs = document.querySelectorAll('#productoForm input, #productoForm textarea, #productoForm select');
        inputs.forEach(input => {
            if (!input.classList.contains('form-control') && !input.classList.contains('form-select') && !input.classList.contains('form-check-input')) {
                if (input.tagName === 'SELECT') {
                    input.classList.add('form-select');
                } else if (input.type === 'checkbox') {
                    input.classList.add('form-check-input');
                } else {
                    input.classList.add('form-control');
                }
            }
        });
    });
</script>
{% endblock %}